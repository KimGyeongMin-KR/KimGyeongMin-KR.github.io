---
title : TIL 2022.12.04 ~
use_math : true
tags : python django drf django-rest-framework js javascript
category : [Study, TIL]

---
찾으시려는 내용은 ctrl + f or cmd + f 를 이용해 주세요 :)
=====


<details>
<summary><span style = "font-size : 1.3em;">[TIL/100일차/12.05]<span style="color : yellow;">bulk_create() 시 유의사항</span></span>ft. 내배캠</summary>
<div markdown ="1">


## bulk_create() 시 유의사항
이미 정해져있는 인스턴스를 저장해야하기 때문에 Model() 인스턴스를 직접 만들어주어 pk값이 지정되게 한다

기존

```python
instance = Goods.objects.create(**validated_data)
image_set = self.context['request'].FILES.getlist('goodsimage_set')
image_list = [{'goods' : instance, 'image' : image}  for image in image_set]
GoodsImage.objects.bulk_create(image_list)
```

변경 후

```python
instance = Goods.objects.create(**validated_data)
image_set = self.context['request'].FILES.getlist('goodsimage_set')
image_list = [GoodsImage(goods = instance, image = image) for image in image_set]
GoodsImage.objects.bulk_create(image_list)
```

**['dict' object has no attribute 'pk' when using Django bulk_create() function](https://stackoverflow.com/questions/57220088/dict-object-has-no-attribute-pk-when-using-django-bulk-create-function)**

</div>
</details>


<details>
<summary><span style = "font-size : 1.3em;">[TIL/101일차/12.06] <span style="color : yellow;">CSS/JS 타이머 만들기, Django image validate</span></span>ft. 내배캠</summary>
<div markdown ="1">


## 타이머 만들기

```html
<div class="pie-timer" style="box-shadow: 0 2px 5px 0px;">
    <div id="center-timer"></div>
</div>
```

```css
.pie-timer {
            position: relative;
            display: inline-block;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            transition: 0.3s;
        }

        #center-timer {
            background: #fff;
            display: block;
            position: absolute;
            top: 50%;
            left: 50%;
            width: 190px;
            height: 190px;
            border-radius: 50%;
            text-align: center;
            line-height: 100px;
            font-size: 20px;
            transform: translate(-50%, -50%);
        }
```

```js
async function startTimer(time) {

    let totalSecond = time

    let x = setInterval(function () {
        let min = parseInt(totalSecond / 60)
        let sec = totalSecond % 60
        let perTime = totalSecond / (60 * 20) * 100
        let percolor = perTime <= 10 ? 'red' : ['yellow', 'blue', 'purple'] [parseInt(perTime / 40)] // 테두리 색상 설정

        document.getElementById('center-timer').innerHTML = min + "분" + sec + "초";
        $('.pie-timer').css({
            "background": "conic-gradient(" + percolor + " 0% " + perTime + "%, #ffffff " + perTime + "% 100%)"
        });
        totalSecond--;

        if (totalSecond < 0) {
            clearInterval(x);
            document.getElementById('center-timer').innerHTML = '종료';
        }
    }, 1000);
}
```


## Django 이미지 확장자 유효성 검사

```python
from django.core.validators import validate_image_file_extension

class GoodsImage(models.Model):
    goods = models.ForeignKey(Goods, on_delete=models.CASCADE)
    image = models.ImageField(upload_to='goods/',validators=[validate_image_file_extension])
```

</div>
</details>